!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("case"),require("base64-js"),require("google-protobuf")):"function"==typeof define&&define.amd?define(["exports","case","base64-js","google-protobuf"],r):r((e="undefined"!=typeof globalThis?globalThis:e||self)["impresso-jscommons"]=e["impresso-jscommons"]||{},e.case,e["base64-js"],e.goog)}(this,function(e,r,t,o){"use strict";function i(e,t){if(void 0===t)return;const o=new e;return Object.keys(t).forEach(e=>{const i=`set${r.pascal(e)}`,s=`set${r.pascal(e)}List`,n=o[i]||o[s];if(void 0===n)throw new Error(`Unknown property: "${e}"`);n.call(o,t[e])}),o}function s(e){return Object.keys(e).reduce((e,r)=>((void 0===e[r]||Array.isArray(e[r])&&0===e[r].length)&&delete e[r],e),e)}function n(e){return Object.keys(e).reduce((e,r)=>(r.endsWith("List")&&(e[r.replace(/List$/,"")]=e[r].map(n),delete e[r]),e),e)}function a(e,t,o=!1){if(!t||0===t)return;const i=Object.keys(e).find(r=>e[r]===t);if(!i)throw new Error(`Unknown enum number: ${t}`);const s=r.camel(i.split("_").slice(1).join("_"));return o?r.upper(s):s}function p(e,t){if(void 0===t)return;const o=[Object.keys(e)[0].split("_")[0],r.upper(r.snake(t),"_")].join("_"),i=e[o];if(void 0===i)throw new Error(`Unknown enum value: ${t} (${o})`);return i}function l(e,r,o){if(void 0===r)return;const s=o?o(r):r;return t.fromByteArray(i(e,s).serializeBinary())}function u(e,r,o){const i=n(e.deserializeBinary(t.toByteArray(r)).toObject());return o?o(i):i}var m,c={};var y=(m||(m=1,function(e){var r=o,t=r,i="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||void 0!==i&&i||"undefined"!=typeof self&&self||function(){return this}.call(null)||Function("return this")();t.exportSymbol("proto.impresso.query.CollectionRecommender",null,i),t.exportSymbol("proto.impresso.query.CollectionRecommender.RecommenderType",null,i),t.exportSymbol("proto.impresso.query.CollectionRecommenderParameter",null,i),t.exportSymbol("proto.impresso.query.CollectionRecommenderParameter.RecommenderParameterId",null,i),t.exportSymbol("proto.impresso.query.CollectionRecommendersSettings",null,i),t.exportSymbol("proto.impresso.query.DateRange",null,i),t.exportSymbol("proto.impresso.query.Filter",null,i),t.exportSymbol("proto.impresso.query.FilterContext",null,i),t.exportSymbol("proto.impresso.query.FilterOperator",null,i),t.exportSymbol("proto.impresso.query.FilterPrecision",null,i),t.exportSymbol("proto.impresso.query.FilterType",null,i),t.exportSymbol("proto.impresso.query.GroupValue",null,i),t.exportSymbol("proto.impresso.query.SearchQuery",null,i),proto.impresso.query.DateRange=function(e){r.Message.initialize(this,e,0,-1,null,null)},t.inherits(proto.impresso.query.DateRange,r.Message),t.DEBUG&&!COMPILED&&(proto.impresso.query.DateRange.displayName="proto.impresso.query.DateRange"),proto.impresso.query.Filter=function(e){r.Message.initialize(this,e,0,-1,proto.impresso.query.Filter.repeatedFields_,null)},t.inherits(proto.impresso.query.Filter,r.Message),t.DEBUG&&!COMPILED&&(proto.impresso.query.Filter.displayName="proto.impresso.query.Filter"),proto.impresso.query.SearchQuery=function(e){r.Message.initialize(this,e,0,-1,proto.impresso.query.SearchQuery.repeatedFields_,null)},t.inherits(proto.impresso.query.SearchQuery,r.Message),t.DEBUG&&!COMPILED&&(proto.impresso.query.SearchQuery.displayName="proto.impresso.query.SearchQuery"),proto.impresso.query.CollectionRecommenderParameter=function(e){r.Message.initialize(this,e,0,-1,null,null)},t.inherits(proto.impresso.query.CollectionRecommenderParameter,r.Message),t.DEBUG&&!COMPILED&&(proto.impresso.query.CollectionRecommenderParameter.displayName="proto.impresso.query.CollectionRecommenderParameter"),proto.impresso.query.CollectionRecommender=function(e){r.Message.initialize(this,e,0,-1,proto.impresso.query.CollectionRecommender.repeatedFields_,null)},t.inherits(proto.impresso.query.CollectionRecommender,r.Message),t.DEBUG&&!COMPILED&&(proto.impresso.query.CollectionRecommender.displayName="proto.impresso.query.CollectionRecommender"),proto.impresso.query.CollectionRecommendersSettings=function(e){r.Message.initialize(this,e,0,-1,proto.impresso.query.CollectionRecommendersSettings.repeatedFields_,null)},t.inherits(proto.impresso.query.CollectionRecommendersSettings,r.Message),t.DEBUG&&!COMPILED&&(proto.impresso.query.CollectionRecommendersSettings.displayName="proto.impresso.query.CollectionRecommendersSettings"),r.Message.GENERATE_TO_OBJECT&&(proto.impresso.query.DateRange.prototype.toObject=function(e){return proto.impresso.query.DateRange.toObject(e,this)},proto.impresso.query.DateRange.toObject=function(e,t){var o={from:r.Message.getFieldWithDefault(t,1,0),to:r.Message.getFieldWithDefault(t,2,0)};return e&&(o.$jspbMessageInstance=t),o}),proto.impresso.query.DateRange.deserializeBinary=function(e){var t=new r.BinaryReader(e),o=new proto.impresso.query.DateRange;return proto.impresso.query.DateRange.deserializeBinaryFromReader(o,t)},proto.impresso.query.DateRange.deserializeBinaryFromReader=function(e,r){for(;r.nextField()&&!r.isEndGroup();)switch(r.getFieldNumber()){case 1:var t=r.readSint64();e.setFrom(t);break;case 2:t=r.readSint64(),e.setTo(t);break;default:r.skipField()}return e},proto.impresso.query.DateRange.prototype.serializeBinary=function(){var e=new r.BinaryWriter;return proto.impresso.query.DateRange.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.impresso.query.DateRange.serializeBinaryToWriter=function(e,r){var t=void 0;0!==(t=e.getFrom())&&r.writeSint64(1,t),0!==(t=e.getTo())&&r.writeSint64(2,t)},proto.impresso.query.DateRange.prototype.getFrom=function(){return r.Message.getFieldWithDefault(this,1,0)},proto.impresso.query.DateRange.prototype.setFrom=function(e){return r.Message.setProto3IntField(this,1,e)},proto.impresso.query.DateRange.prototype.getTo=function(){return r.Message.getFieldWithDefault(this,2,0)},proto.impresso.query.DateRange.prototype.setTo=function(e){return r.Message.setProto3IntField(this,2,e)},proto.impresso.query.Filter.repeatedFields_=[5,7],r.Message.GENERATE_TO_OBJECT&&(proto.impresso.query.Filter.prototype.toObject=function(e){return proto.impresso.query.Filter.toObject(e,this)},proto.impresso.query.Filter.toObject=function(e,t){var o,i={context:r.Message.getFieldWithDefault(t,1,0),op:r.Message.getFieldWithDefault(t,2,0),type:r.Message.getFieldWithDefault(t,3,0),precision:r.Message.getFieldWithDefault(t,4,0),qList:null==(o=r.Message.getRepeatedField(t,5))?void 0:o,daterange:(o=t.getDaterange())&&proto.impresso.query.DateRange.toObject(e,o),uidsList:null==(o=r.Message.getRepeatedField(t,7))?void 0:o};return e&&(i.$jspbMessageInstance=t),i}),proto.impresso.query.Filter.deserializeBinary=function(e){var t=new r.BinaryReader(e),o=new proto.impresso.query.Filter;return proto.impresso.query.Filter.deserializeBinaryFromReader(o,t)},proto.impresso.query.Filter.deserializeBinaryFromReader=function(e,r){for(;r.nextField()&&!r.isEndGroup();)switch(r.getFieldNumber()){case 1:var t=r.readEnum();e.setContext(t);break;case 2:t=r.readEnum(),e.setOp(t);break;case 3:t=r.readEnum(),e.setType(t);break;case 4:t=r.readEnum(),e.setPrecision(t);break;case 5:t=r.readString(),e.addQ(t);break;case 6:t=new proto.impresso.query.DateRange,r.readMessage(t,proto.impresso.query.DateRange.deserializeBinaryFromReader),e.setDaterange(t);break;case 7:t=r.readString(),e.addUids(t);break;default:r.skipField()}return e},proto.impresso.query.Filter.prototype.serializeBinary=function(){var e=new r.BinaryWriter;return proto.impresso.query.Filter.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.impresso.query.Filter.serializeBinaryToWriter=function(e,r){var t=void 0;0!==(t=e.getContext())&&r.writeEnum(1,t),0!==(t=e.getOp())&&r.writeEnum(2,t),0!==(t=e.getType())&&r.writeEnum(3,t),0!==(t=e.getPrecision())&&r.writeEnum(4,t),(t=e.getQList()).length>0&&r.writeRepeatedString(5,t),null!=(t=e.getDaterange())&&r.writeMessage(6,t,proto.impresso.query.DateRange.serializeBinaryToWriter),(t=e.getUidsList()).length>0&&r.writeRepeatedString(7,t)},proto.impresso.query.Filter.prototype.getContext=function(){return r.Message.getFieldWithDefault(this,1,0)},proto.impresso.query.Filter.prototype.setContext=function(e){return r.Message.setProto3EnumField(this,1,e)},proto.impresso.query.Filter.prototype.getOp=function(){return r.Message.getFieldWithDefault(this,2,0)},proto.impresso.query.Filter.prototype.setOp=function(e){return r.Message.setProto3EnumField(this,2,e)},proto.impresso.query.Filter.prototype.getType=function(){return r.Message.getFieldWithDefault(this,3,0)},proto.impresso.query.Filter.prototype.setType=function(e){return r.Message.setProto3EnumField(this,3,e)},proto.impresso.query.Filter.prototype.getPrecision=function(){return r.Message.getFieldWithDefault(this,4,0)},proto.impresso.query.Filter.prototype.setPrecision=function(e){return r.Message.setProto3EnumField(this,4,e)},proto.impresso.query.Filter.prototype.getQList=function(){return r.Message.getRepeatedField(this,5)},proto.impresso.query.Filter.prototype.setQList=function(e){return r.Message.setField(this,5,e||[])},proto.impresso.query.Filter.prototype.addQ=function(e,t){return r.Message.addToRepeatedField(this,5,e,t)},proto.impresso.query.Filter.prototype.clearQList=function(){return this.setQList([])},proto.impresso.query.Filter.prototype.getDaterange=function(){return r.Message.getWrapperField(this,proto.impresso.query.DateRange,6)},proto.impresso.query.Filter.prototype.setDaterange=function(e){return r.Message.setWrapperField(this,6,e)},proto.impresso.query.Filter.prototype.clearDaterange=function(){return this.setDaterange(void 0)},proto.impresso.query.Filter.prototype.hasDaterange=function(){return null!=r.Message.getField(this,6)},proto.impresso.query.Filter.prototype.getUidsList=function(){return r.Message.getRepeatedField(this,7)},proto.impresso.query.Filter.prototype.setUidsList=function(e){return r.Message.setField(this,7,e||[])},proto.impresso.query.Filter.prototype.addUids=function(e,t){return r.Message.addToRepeatedField(this,7,e,t)},proto.impresso.query.Filter.prototype.clearUidsList=function(){return this.setUidsList([])},proto.impresso.query.SearchQuery.repeatedFields_=[1],r.Message.GENERATE_TO_OBJECT&&(proto.impresso.query.SearchQuery.prototype.toObject=function(e){return proto.impresso.query.SearchQuery.toObject(e,this)},proto.impresso.query.SearchQuery.toObject=function(e,t){var o={filtersList:r.Message.toObjectList(t.getFiltersList(),proto.impresso.query.Filter.toObject,e),groupBy:r.Message.getFieldWithDefault(t,2,0)};return e&&(o.$jspbMessageInstance=t),o}),proto.impresso.query.SearchQuery.deserializeBinary=function(e){var t=new r.BinaryReader(e),o=new proto.impresso.query.SearchQuery;return proto.impresso.query.SearchQuery.deserializeBinaryFromReader(o,t)},proto.impresso.query.SearchQuery.deserializeBinaryFromReader=function(e,r){for(;r.nextField()&&!r.isEndGroup();)switch(r.getFieldNumber()){case 1:var t=new proto.impresso.query.Filter;r.readMessage(t,proto.impresso.query.Filter.deserializeBinaryFromReader),e.addFilters(t);break;case 2:t=r.readEnum(),e.setGroupBy(t);break;default:r.skipField()}return e},proto.impresso.query.SearchQuery.prototype.serializeBinary=function(){var e=new r.BinaryWriter;return proto.impresso.query.SearchQuery.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.impresso.query.SearchQuery.serializeBinaryToWriter=function(e,r){var t=void 0;(t=e.getFiltersList()).length>0&&r.writeRepeatedMessage(1,t,proto.impresso.query.Filter.serializeBinaryToWriter),0!==(t=e.getGroupBy())&&r.writeEnum(2,t)},proto.impresso.query.SearchQuery.prototype.getFiltersList=function(){return r.Message.getRepeatedWrapperField(this,proto.impresso.query.Filter,1)},proto.impresso.query.SearchQuery.prototype.setFiltersList=function(e){return r.Message.setRepeatedWrapperField(this,1,e)},proto.impresso.query.SearchQuery.prototype.addFilters=function(e,t){return r.Message.addToRepeatedWrapperField(this,1,e,proto.impresso.query.Filter,t)},proto.impresso.query.SearchQuery.prototype.clearFiltersList=function(){return this.setFiltersList([])},proto.impresso.query.SearchQuery.prototype.getGroupBy=function(){return r.Message.getFieldWithDefault(this,2,0)},proto.impresso.query.SearchQuery.prototype.setGroupBy=function(e){return r.Message.setProto3EnumField(this,2,e)},r.Message.GENERATE_TO_OBJECT&&(proto.impresso.query.CollectionRecommenderParameter.prototype.toObject=function(e){return proto.impresso.query.CollectionRecommenderParameter.toObject(e,this)},proto.impresso.query.CollectionRecommenderParameter.toObject=function(e,t){var o={key:r.Message.getFieldWithDefault(t,1,0),stringValue:r.Message.getFieldWithDefault(t,2,""),numberValue:r.Message.getFieldWithDefault(t,3,0),boolValue:r.Message.getBooleanFieldWithDefault(t,4,!1)};return e&&(o.$jspbMessageInstance=t),o}),proto.impresso.query.CollectionRecommenderParameter.deserializeBinary=function(e){var t=new r.BinaryReader(e),o=new proto.impresso.query.CollectionRecommenderParameter;return proto.impresso.query.CollectionRecommenderParameter.deserializeBinaryFromReader(o,t)},proto.impresso.query.CollectionRecommenderParameter.deserializeBinaryFromReader=function(e,r){for(;r.nextField()&&!r.isEndGroup();)switch(r.getFieldNumber()){case 1:var t=r.readEnum();e.setKey(t);break;case 2:t=r.readString(),e.setStringValue(t);break;case 3:t=r.readSint32(),e.setNumberValue(t);break;case 4:t=r.readBool(),e.setBoolValue(t);break;default:r.skipField()}return e},proto.impresso.query.CollectionRecommenderParameter.prototype.serializeBinary=function(){var e=new r.BinaryWriter;return proto.impresso.query.CollectionRecommenderParameter.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.impresso.query.CollectionRecommenderParameter.serializeBinaryToWriter=function(e,r){var t=void 0;0!==(t=e.getKey())&&r.writeEnum(1,t),(t=e.getStringValue()).length>0&&r.writeString(2,t),0!==(t=e.getNumberValue())&&r.writeSint32(3,t),(t=e.getBoolValue())&&r.writeBool(4,t)},proto.impresso.query.CollectionRecommenderParameter.RecommenderParameterId={ID_UNSPECIFIED:0,ID_COUNT_TYPE:1,ID_MIN_OCCURRENCES:2,ID_NUMBER_TO_KEEP:3,ID_REMOVE_FULLY_MENTIONED:4,ID_NORMALIZE_MAX_SCORE:5,ID_MARGIN:6,ID_SCALING_FACTOR:7},proto.impresso.query.CollectionRecommenderParameter.prototype.getKey=function(){return r.Message.getFieldWithDefault(this,1,0)},proto.impresso.query.CollectionRecommenderParameter.prototype.setKey=function(e){return r.Message.setProto3EnumField(this,1,e)},proto.impresso.query.CollectionRecommenderParameter.prototype.getStringValue=function(){return r.Message.getFieldWithDefault(this,2,"")},proto.impresso.query.CollectionRecommenderParameter.prototype.setStringValue=function(e){return r.Message.setProto3StringField(this,2,e)},proto.impresso.query.CollectionRecommenderParameter.prototype.getNumberValue=function(){return r.Message.getFieldWithDefault(this,3,0)},proto.impresso.query.CollectionRecommenderParameter.prototype.setNumberValue=function(e){return r.Message.setProto3IntField(this,3,e)},proto.impresso.query.CollectionRecommenderParameter.prototype.getBoolValue=function(){return r.Message.getBooleanFieldWithDefault(this,4,!1)},proto.impresso.query.CollectionRecommenderParameter.prototype.setBoolValue=function(e){return r.Message.setProto3BooleanField(this,4,e)},proto.impresso.query.CollectionRecommender.repeatedFields_=[3],r.Message.GENERATE_TO_OBJECT&&(proto.impresso.query.CollectionRecommender.prototype.toObject=function(e){return proto.impresso.query.CollectionRecommender.toObject(e,this)},proto.impresso.query.CollectionRecommender.toObject=function(e,t){var o={type:r.Message.getFieldWithDefault(t,1,0),weight:r.Message.getFieldWithDefault(t,2,0),parametersList:r.Message.toObjectList(t.getParametersList(),proto.impresso.query.CollectionRecommenderParameter.toObject,e),enabled:r.Message.getBooleanFieldWithDefault(t,4,!1)};return e&&(o.$jspbMessageInstance=t),o}),proto.impresso.query.CollectionRecommender.deserializeBinary=function(e){var t=new r.BinaryReader(e),o=new proto.impresso.query.CollectionRecommender;return proto.impresso.query.CollectionRecommender.deserializeBinaryFromReader(o,t)},proto.impresso.query.CollectionRecommender.deserializeBinaryFromReader=function(e,r){for(;r.nextField()&&!r.isEndGroup();)switch(r.getFieldNumber()){case 1:var t=r.readEnum();e.setType(t);break;case 2:t=r.readSint32(),e.setWeight(t);break;case 3:t=new proto.impresso.query.CollectionRecommenderParameter,r.readMessage(t,proto.impresso.query.CollectionRecommenderParameter.deserializeBinaryFromReader),e.addParameters(t);break;case 4:t=r.readBool(),e.setEnabled(t);break;default:r.skipField()}return e},proto.impresso.query.CollectionRecommender.prototype.serializeBinary=function(){var e=new r.BinaryWriter;return proto.impresso.query.CollectionRecommender.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.impresso.query.CollectionRecommender.serializeBinaryToWriter=function(e,r){var t=void 0;0!==(t=e.getType())&&r.writeEnum(1,t),0!==(t=e.getWeight())&&r.writeSint32(2,t),(t=e.getParametersList()).length>0&&r.writeRepeatedMessage(3,t,proto.impresso.query.CollectionRecommenderParameter.serializeBinaryToWriter),(t=e.getEnabled())&&r.writeBool(4,t)},proto.impresso.query.CollectionRecommender.RecommenderType={TYPE_UNSPECIFIED:0,TYPE_TIME_RANGE:1,TYPE_ENTITIES:2,TYPE_TOPICS:3,TYPE_TEXT_REUSE_CLUSTERS:4},proto.impresso.query.CollectionRecommender.prototype.getType=function(){return r.Message.getFieldWithDefault(this,1,0)},proto.impresso.query.CollectionRecommender.prototype.setType=function(e){return r.Message.setProto3EnumField(this,1,e)},proto.impresso.query.CollectionRecommender.prototype.getWeight=function(){return r.Message.getFieldWithDefault(this,2,0)},proto.impresso.query.CollectionRecommender.prototype.setWeight=function(e){return r.Message.setProto3IntField(this,2,e)},proto.impresso.query.CollectionRecommender.prototype.getParametersList=function(){return r.Message.getRepeatedWrapperField(this,proto.impresso.query.CollectionRecommenderParameter,3)},proto.impresso.query.CollectionRecommender.prototype.setParametersList=function(e){return r.Message.setRepeatedWrapperField(this,3,e)},proto.impresso.query.CollectionRecommender.prototype.addParameters=function(e,t){return r.Message.addToRepeatedWrapperField(this,3,e,proto.impresso.query.CollectionRecommenderParameter,t)},proto.impresso.query.CollectionRecommender.prototype.clearParametersList=function(){return this.setParametersList([])},proto.impresso.query.CollectionRecommender.prototype.getEnabled=function(){return r.Message.getBooleanFieldWithDefault(this,4,!1)},proto.impresso.query.CollectionRecommender.prototype.setEnabled=function(e){return r.Message.setProto3BooleanField(this,4,e)},proto.impresso.query.CollectionRecommendersSettings.repeatedFields_=[1],r.Message.GENERATE_TO_OBJECT&&(proto.impresso.query.CollectionRecommendersSettings.prototype.toObject=function(e){return proto.impresso.query.CollectionRecommendersSettings.toObject(e,this)},proto.impresso.query.CollectionRecommendersSettings.toObject=function(e,t){var o={recommendersList:r.Message.toObjectList(t.getRecommendersList(),proto.impresso.query.CollectionRecommender.toObject,e)};return e&&(o.$jspbMessageInstance=t),o}),proto.impresso.query.CollectionRecommendersSettings.deserializeBinary=function(e){var t=new r.BinaryReader(e),o=new proto.impresso.query.CollectionRecommendersSettings;return proto.impresso.query.CollectionRecommendersSettings.deserializeBinaryFromReader(o,t)},proto.impresso.query.CollectionRecommendersSettings.deserializeBinaryFromReader=function(e,r){for(;r.nextField()&&!r.isEndGroup();)if(1===r.getFieldNumber()){var t=new proto.impresso.query.CollectionRecommender;r.readMessage(t,proto.impresso.query.CollectionRecommender.deserializeBinaryFromReader),e.addRecommenders(t)}else r.skipField();return e},proto.impresso.query.CollectionRecommendersSettings.prototype.serializeBinary=function(){var e=new r.BinaryWriter;return proto.impresso.query.CollectionRecommendersSettings.serializeBinaryToWriter(this,e),e.getResultBuffer()},proto.impresso.query.CollectionRecommendersSettings.serializeBinaryToWriter=function(e,r){var t;(t=e.getRecommendersList()).length>0&&r.writeRepeatedMessage(1,t,proto.impresso.query.CollectionRecommender.serializeBinaryToWriter)},proto.impresso.query.CollectionRecommendersSettings.prototype.getRecommendersList=function(){return r.Message.getRepeatedWrapperField(this,proto.impresso.query.CollectionRecommender,1)},proto.impresso.query.CollectionRecommendersSettings.prototype.setRecommendersList=function(e){return r.Message.setRepeatedWrapperField(this,1,e)},proto.impresso.query.CollectionRecommendersSettings.prototype.addRecommenders=function(e,t){return r.Message.addToRepeatedWrapperField(this,1,e,proto.impresso.query.CollectionRecommender,t)},proto.impresso.query.CollectionRecommendersSettings.prototype.clearRecommendersList=function(){return this.setRecommendersList([])},proto.impresso.query.FilterContext={CONTEXT_UNSPECIFIED:0,CONTEXT_INCLUDE:1,CONTEXT_EXCLUDE:2},proto.impresso.query.FilterOperator={OPERATOR_UNSPECIFIED:0,OPERATOR_AND:1,OPERATOR_OR:2},proto.impresso.query.FilterType={TYPE_UNSPECIFIED:0,TYPE_UID:1,TYPE_HAS_TEXT_CONTENTS:2,TYPE_TITLE:3,TYPE_IS_FRONT:4,TYPE_PAGE:5,TYPE_ISSUE:6,TYPE_STRING:7,TYPE_ENTITY:8,TYPE_NEWSPAPER:9,TYPE_DATERANGE:10,TYPE_YEAR:11,TYPE_LANGUAGE:12,TYPE_TYPE:13,TYPE_REGEX:14,TYPE_MENTION:15,TYPE_PERSON:16,TYPE_LOCATION:17,TYPE_TOPIC:18,TYPE_COLLECTION:19,TYPE_OCR_QUALITY:20,TYPE_CONTENT_LENGTH:21,TYPE_COUNTRY:22,TYPE_ACCESS_RIGHT:23,TYPE_PARTNER:24,TYPE_MONTH:25,TYPE_TEXT_REUSE_CLUSTER_SIZE:26,TYPE_TEXT_REUSE_CLUSTER_LEXICAL_OVERLAP:27,TYPE_TEXT_REUSE_CLUSTER_DAY_DELTA:28,TYPE_TEXT_REUSE_CLUSTER:29,TYPE_MENTION_FUNCTION:30,TYPE_NAG:31,TYPE_WIKIDATA_ID:32,TYPE_DATA_DOMAIN:33,TYPE_COPYRIGHT:34,TYPE_SOURCE_TYPE:35,TYPE_SOURCE_MEDIUM:36,TYPE_ORGANISATION:37,TYPE_EMBEDDING:38,TYPE_IMAGE_VISUAL_CONTENT:39,TYPE_IMAGE_TECHNIQUE:40,TYPE_IMAGE_COMMUNICATION_GOAL:41,TYPE_IMAGE_CONTENT_TYPE:42},proto.impresso.query.FilterPrecision={PRECISION_UNSPECIFIED:0,PRECISION_EXACT:1,PRECISION_PARTIAL:2,PRECISION_FUZZY:3,PRECISION_SOFT:4},proto.impresso.query.GroupValue={GROUPVALUE_UNSPECIFIED:0,GROUPVALUE_ARTICLES:1},t.object.extend(e,proto.impresso.query)}(c)),c);function d(e){if(void 0!==e)return{from:Date.parse(e.from),to:Date.parse(e.to)}}function g(e){if(void 0!==e)return{from:new Date(e.from).toISOString(),to:new Date(e.to).toISOString()}}function f(e){return{...e,q:(r=e.q,"string"==typeof r||r instanceof String?[r]:r),context:p(y.FilterContext,e.context),op:p(y.FilterOperator,e.op),type:p(y.FilterType,e.type),precision:p(y.FilterPrecision,e.precision),daterange:i(y.DateRange,d(e.daterange))};var r}function R(e){return s({...e,q:(r=e.q,void 0!==r&&1===r.length?r[0]:r),context:a(y.FilterContext,e.context),op:a(y.FilterOperator,e.op,!0),type:a(y.FilterType,e.type),precision:a(y.FilterPrecision,e.precision),daterange:g(e.daterange)});var r}function E(e){return{...e,filters:(e.filters||[]).map(e=>i(y.Filter,f(e))),groupBy:p(y.GroupValue,e.groupBy)}}function F(e){return s({...e,filters:(e.filters||[]).map(R),groupBy:a(y.GroupValue,e.groupBy)})}function q(e,r=2){if(null!=e)return parseFloat(e.toFixed(r))*10**r}function T(e,r=2){if(null!=e)return e/10**r}function C(e){return s({...e,type:p(y.CollectionRecommender.RecommenderType,e.type),weight:q(e.weight),parameters:(e.parameters||[]).map(e=>i(y.CollectionRecommenderParameter,function(e){let r,t,o;return"number"==typeof e.value&&(t=q(e.value)),"string"==typeof e.value&&(r=e.value),"boolean"==typeof e.value&&(o=e.value),{key:p(y.CollectionRecommenderParameter.RecommenderParameterId,e.key),stringValue:r,numberValue:t,boolValue:o}}(e)))})}function h(e){return s({...e,recommenders:(e.recommenders||[]).map(e=>i(y.CollectionRecommender,C(e)))})}function P(e){let r;return null!=e.boolValue&&(r=e.boolValue),0!==e.numberValue&&(r=T(e.numberValue)),""!==e.stringValue&&(r=e.stringValue),s({key:a(y.CollectionRecommenderParameter.RecommenderParameterId,e.key,!1),value:r})}function _(e){return s({...e,type:a(y.CollectionRecommender.RecommenderType,e.type,!1),weight:T(e.weight)||0,parameters:(e.parameters||[]).map(P),enabled:e.enabled||void 0})}function S(e){return s({recommenders:(e.recommenders||[]).map(_)})}var O={filter:{serialize:e=>l(y.Filter,e,f),deserialize:e=>u(y.Filter,e,R)},searchQuery:{serialize:e=>l(y.SearchQuery,e,E),deserialize:e=>u(y.SearchQuery,e,F)},collectionRecommendersSettings:{serialize:e=>l(y.CollectionRecommendersSettings,e,h),deserialize:e=>u(y.CollectionRecommendersSettings,e,S)}};var M={filter:{Types:Object.freeze(Object.keys(y.FilterType).filter(e=>y.FilterType[e]!==y.FilterType.TYPE_UNSPECIFIED).map(e=>r.camel(e.split("_").slice(1).join("_")))),Operators:Object.freeze(Object.keys(y.FilterOperator).filter(e=>y.FilterOperator[e]!==y.FilterOperator.OPERATOR_UNSPECIFIED).map(e=>r.camel(e.split("_").slice(1).join("_")).toUpperCase())),Contexts:Object.freeze(Object.keys(y.FilterContext).filter(e=>y.FilterContext[e]!==y.FilterContext.CONTEXT_UNSPECIFIED).map(e=>r.camel(e.split("_").slice(1).join("_")).toLowerCase())),Precision:Object.freeze(Object.keys(y.FilterPrecision).filter(e=>y.FilterPrecision[e]!==y.FilterPrecision.PRECISION_UNSPECIFIED).map(e=>r.camel(e.split("_").slice(1).join("_")).toLowerCase()))}};function b(e){const r=e.reduce((e,r)=>{const t=(({type:e,op:r="OR",context:t="include",precision:o="exact"})=>`t:${e}-o:${r}-c:${t}-p:${o}`)(r),o=e.get(t)||[];return e.set(t,o.concat([r])),e},new Map);return[...r.entries()].map(([,e])=>{const{type:r,context:t,precision:o,op:i}=e[0],s=e.flatMap(({q:e})=>Array.isArray(e)?e:[e]).filter(e=>null!=e);return n={type:r,context:t,precision:o,op:i,q:s.length>1?s:s[0]},a=e=>null==e,Object.keys(n).reduce((e,r)=>{const t=n[r];return a(t)||(e[r]=t),e},{});var n,a})}var D={filter:Object.freeze({__proto__:null,mergeFilters:function(e){return b(e.flat().map(e=>{const r=Array.isArray(e.q)&&1===e.q.length||!Array.isArray(e.q)?"AND":e.op;return{...e,op:r}}))},optimizeFilters:b})},I={Filter:{$schema:"http://json-schema.org/draft-07/schema#",title:"Filter",description:"Filter object",type:"object",required:["type"],properties:{q:{oneOf:[{type:"array",items:{type:"string"}},{type:"string"}],description:"Query string or array of strings"},type:{type:"string",description:"The filter type",enum:M.filter.Types},context:{type:"string",description:"The filter context (without CONTEXT_ prefix and in camelCase)",enum:M.filter.Contexts},precision:{type:"string",description:"The filter precision (without PRECISION_ prefix and in camelCase)",enum:M.filter.Precision},op:{type:"string",description:"The filter operator (without OP_ prefix and in uppercase)",enum:M.filter.Operators},uids:{type:"array",items:{type:"string"},description:"Array of unique identifiers"}}}};e.constants=M,e.jsonSchemas=I,e.logic=D,e.protobuf=O});
